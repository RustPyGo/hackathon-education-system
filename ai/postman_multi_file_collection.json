{
  "info": {
    "name": "AI Question Generator - Multi-File Support",
    "description": "API tạo câu hỏi trắc nghiệm từ nhiều file PDF với caching system",
    "version": "2.0.0"
  },
  "variable": [
    {
      "key": "http://localhost:8000",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "task_id", 
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/health",
          "host": ["{{base_url}}"],
          "path": ["api", "health"]
        },
        "description": "Kiểm tra trạng thái server và cache system"
      }
    },
    {
      "name": "2. Multi-File Sync (2 files, 8 questions)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"files\": [\n    {\n      \"url\": \"https://prj301.hcm.ss.bfcplatform.vn/pdfs/745b0242-e629-407a-b452-bdde4044adb0/1751095113.pdf\",\n      \"file_name\": \"document1.pdf\"\n    },\n    {\n      \"url\": \"https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf\",\n      \"file_name\": \"document2.pdf\"\n    }\n  ],\n  \"project_id\": \"test-project-123\",\n  \"total_questions\": 8,\n  \"name\": \"Multi-File Test\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/generate-questions-sync",
          "host": ["{{base_url}}"],
          "path": ["api", "generate-questions-sync"]
        },
        "description": "Tạo câu hỏi từ 2 files (sync) - chia đều 4-4 câu"
      }
    },
    {
      "name": "3. Multi-File Async (3 files, 15 questions)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"files\": [\n    {\n      \"url\": \"https://prj301.hcm.ss.bfcplatform.vn/pdfs/745b0242-e629-407a-b452-bdde4044adb0/1751095113.pdf\",\n      \"file_name\": \"math_doc.pdf\"\n    },\n    {\n      \"url\": \"https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf\",\n      \"file_name\": \"science_doc.pdf\"\n    },\n    {\n      \"url\": \"https://example.com/another-doc.pdf\",\n      \"file_name\": \"history_doc.pdf\"\n    }\n  ],\n  \"project_id\": \"async-project-456\",\n  \"total_questions\": 15,\n  \"name\": \"Multi-Subject Exam\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/generate-questions",
          "host": ["{{base_url}}"],
          "path": ["api", "generate-questions"]
        },
        "description": "Tạo câu hỏi từ 3 files (async) - chia đều 5-5-5 câu"
      }
    },
    {
      "name": "4. Check Task Status",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/task-status/{{task_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "task-status", "{{task_id}}"]
        },
        "description": "Kiểm tra trạng thái task async"
      }
    },
    {
      "name": "5. Get Task Result",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/task-result/{{task_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "task-result", "{{task_id}}"]
        },
        "description": "Lấy kết quả task async"
      }
    },
    {
      "name": "6. Cache Information",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/cache/info",
          "host": ["{{base_url}}"],
          "path": ["api", "cache", "info"]
        },
        "description": "Xem thông tin cache system"
      }
    },
    {
      "name": "7. Clear Cache",
      "request": {
        "method": "DELETE",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/cache/clear",
          "host": ["{{base_url}}"],
          "path": ["api", "cache", "clear"]
        },
        "description": "Xóa tất cả cache"
      }
    },
    {
      "name": "8. Error Handling Test",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"files\": [\n    {\n      \"url\": \"https://prj301.hcm.ss.bfcplatform.vn/pdfs/745b0242-e629-407a-b452-bdde4044adb0/1751095113.pdf\",\n      \"file_name\": \"valid_doc.pdf\"\n    },\n    {\n      \"url\": \"https://invalid-url-does-not-exist.com/fake.pdf\",\n      \"file_name\": \"invalid_doc.pdf\"\n    }\n  ],\n  \"project_id\": \"error-test-789\",\n  \"total_questions\": 6,\n  \"name\": \"Error Handling Test\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/generate-questions-sync",
          "host": ["{{base_url}}"],
          "path": ["api", "generate-questions-sync"]
        },
        "description": "Test error handling với mixed valid/invalid files"
      }
    },
    {
      "name": "9. Single File (Legacy Support)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"s3_url\": \"https://prj301.hcm.ss.bfcplatform.vn/pdfs/745b0242-e629-407a-b452-bdde4044adb0/1751095113.pdf\",\n  \"total_question\": 5\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/generate-questions-single-sync",
          "host": ["{{base_url}}"],
          "path": ["api", "generate-questions-single-sync"]
        },
        "description": "Legacy endpoint cho single file"
      }
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Auto-extract task_id from response for async requests",
          "if (pm.info.requestName.includes('Multi-File Async')) {",
          "    pm.sendRequest(pm.request, function (err, response) {",
          "        if (response && response.json() && response.json().task_id) {",
          "            pm.globals.set('task_id', response.json().task_id);",
          "        }",
          "    });",
          "}"
        ]
      }
    }
  ]
}
